{% extends 'tvshow/header.html' %}

{% block content %}
<div class="card-deck">
  <div class="card">
    <img class="card-img-top img-fluid" src="{{show.banner}}" alt="Card image cap">
    <div class="card-block">
      <a target="_blank" href="http://www.imdb.com/title/{{show.imbdID}}"><h3 class="card-title text-xs-center">{{show.seriesName}}</h4></a>
      <progress class="progress progress-striped" value="{{show.episode_watch_count}}" max="{{show.total_episodes}}"></progress>
      <p class="card-text">
        {{show.overview}}
      </p>
    </div>
  </div>

  <div class="card">
    <div class="card-header">Seasons</div>
    <div class="list-group list-group-flush">
      {% for season in show.season_set.all %}
      <a class="list-group-item" data-toggle="modal" data-target="#s{{season.number}}">
        Season {{season.number}} <small> Watched {{season.watch_count}} of {{season.episode_count}} episodes.</small>
      </a>
      {% endfor %}
    </div>
  </div>

  <div class="card">
    {% if next_episode %}
    <ul class="list-group">
      <li class="list-group-item list-group-item-success">Next to Watch</li>
      <li class="list-group-item">
        {{next_episode.number}}. <a data-toggle="collapse" href="#collapseE{{next_episode.number}}" aria-expanded="false" aria-controls="collapseE{{next_episode.number}}">{{next_episode.episodeName}}</a> <small>{{next_episode.firstAired}}</small>
        <form class='form-inline pull-xs-right' action="/episode_swt" method="post">{% csrf_token %}
          <input type="hidden" name="episode_swt" value="{{next_episode.id}}">
          {% if next_episode.status_watched == True %}
          <input type="checkbox" onclick="this.form.submit();" checked>
          {% else %}
          <input type="checkbox" onclick="this.form.submit();">
          {% endif %}
        </form>
      </li>
      <div class="collapse" id="collapseE{{next_episode.number}}">
        <div class="card-block card-inverse card-danger">
          <p class="card-text">
            {{next_episode.overview}}
          </p>
        </div>
      </div>
    </ul>
    {% endif %}
  </div>
</div>

{% for season in show.season_set.all %}
{% include 'tvshow/single_season_modal_snippet.html' with season=season %}
{% endfor %}
{% endblock %}
